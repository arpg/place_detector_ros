<launch>

<arg name = "mode" default = "realtime_prediction"/>
<arg name = "file_path" default = "$(find place_detector)/data"/>
<arg name = "rviz_config" default = "$(find place_detector)/rviz/realtime_prediction.rviz"/>
<arg name = "bag_file_path" default = "$(find place_detector)/bags/EC_data.bag"/>

<arg name = "angle_min" value = "-3.141592653589793238" doc="negative 180 degrees"/>
<arg name = "angle_inc" value = "$(eval 3.141592653589793238/180)" doc="1 degree resolution"/>
<arg name = "angle_max" value = "$(eval 3.141592653589793238 - 3.141592653589793238/180)" doc="180 degrees minus increment"/>

<param name = "use_sim_time" value = "true"/>

<node name="place_detector" type="place_detector_node" pkg="place_detector" output="screen">
  <param name="mode" value="$(arg mode)"/>
  <param name="file_path" value="$(arg file_path)"/>
</node>

<node name="ptcloud_throttler" type="throttle" pkg="topic_tools" args="messages ouster/points 5 ouster/points_throttled"/>

<node name="pointcloud_to_laserscan" type="pointcloud_to_laserscan_node" pkg="pointcloud_to_laserscan" output="screen">
  <remap from = "cloud_in" to = "ouster/points_throttled"/>
  <remap from = "scan" to = "/place_detector/scan_in"/>

  <param name="angle_min" value = "$(arg angle_min)"/>
  <param name="angle_max" value = "$(eval angle_max)"/>
	<param name="angle_increment" value = "$(arg angle_inc)"/>
  <param name="range_min" value = "0.01"/>
  <param name="range_max" value = "7.5"/>
  <param name="min_height" value = "0"/>
  <param name="max_height" value = "0.75"/>
  <param name="use_inf" value = "true"/>
</node>

<node pkg="rviz" type="rviz" name="place_detector_ui" output="screen" args="-d $(arg rviz_config)"/>
<node pkg="rosbag" type="play" name="rosbag_play" output="screen" args="--clock $(arg bag_file_path) --pause"/>
</launch>
